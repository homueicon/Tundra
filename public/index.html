<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LAN Chat - Secure Local Network Messaging</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Network Status Indicator -->
  <div id="networkStatus" class="network-status" style="display: none;">
    <div class="status-dot"></div>
    <span id="networkStatusText">Connected to LAN</span>
  </div>

  <!-- Login Screen -->
  <div id="loginScreen" class="screen active">
    <div class="login-container">
      <h1>Welcome</h1>
      <div class="tabs">
        <button class="tab active" onclick="showLoginForm()">Login</button>
        <button class="tab" onclick="showRegisterForm()">Register</button>
      </div>
      
      <form id="loginForm" class="auth-form active">
        <input type="text" id="loginUsername" placeholder="Username" required>
        <input type="password" id="loginPassword" placeholder="Password" required>
        <button type="submit">Login</button>
        <div id="loginError" class="error"></div>
      </form>
      
      <form id="registerForm" class="auth-form">
        <input type="text" id="regUsername" placeholder="Username" required>
        <input type="email" id="regEmail" placeholder="Email" required>
        <input type="text" id="regDisplayName" placeholder="Display Name">
        <input type="password" id="regPassword" placeholder="Password" required>
        <button type="submit">Register</button>
        <div id="registerError" class="error"></div>
      </form>
    </div>
  </div>

  <!-- Main App Screen -->
  <div id="appScreen" class="screen">
    <div class="app-container">
      <!-- Sidebar -->
      <div class="sidebar">
        <div class="user-profile">
          <div class="avatar" id="userAvatar"></div>
          <div class="user-info">
            <div class="username" id="currentUsername"></div>
            <div class="status online">Online</div>
          </div>
          <button class="settings-btn" onclick="showSettings()" title="Settings">‚öôÔ∏è</button>
        </div>

        <div class="sidebar-tabs">
          <button class="sidebar-tab active" onclick="showTab('rooms')">Rooms</button>
          <button class="sidebar-tab" onclick="showTab('contacts')">Contacts</button>
        </div>

        <!-- Rooms List -->
        <div id="roomsTab" class="tab-content active">
          <div class="tab-header">
            <h3>Rooms</h3>
            <button onclick="showCreateRoomModal()">+</button>
          </div>
          <div id="roomsList" class="list"></div>
        </div>

        <!-- Contacts List -->
        <div id="contactsTab" class="tab-content">
          <div class="tab-header">
            <h3>Contacts</h3>
            <button onclick="showAddContactModal()">+</button>
          </div>
          <div id="contactsList" class="list"></div>
        </div>
      </div>

      <!-- Chat Area -->
      <div class="chat-area">
        <div class="chat-header">
          <h2 id="currentRoomName">Select a room</h2>
          <div class="chat-actions">
            <button onclick="showInviteModal()" title="Invite members">üë•</button>
            <button onclick="showRoomInfo()" title="Room info">‚ÑπÔ∏è</button>
          </div>
        </div>

        <div id="messagesContainer" class="messages-container"></div>

        <div class="message-input-container">
          <button class="attach-btn" onclick="attachFile()" title="Attach file">üìé</button>
          <input type="file" id="fileInput" style="display: none;" onchange="handleFileSelect()">
          <input type="text" id="messageInput" placeholder="Type a message..." disabled>
          <button id="sendButton" onclick="sendMessage()" disabled>Send</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Create Room Modal -->
  <div id="createRoomModal" class="modal">
    <div class="modal-content">
      <h2>Create Room</h2>
      <input type="text" id="roomName" placeholder="Room Name" required>
      <textarea id="roomDescription" placeholder="Description"></textarea>
      <select id="roomType">
        <option value="public">Public</option>
        <option value="private">Private</option>
      </select>
      <div class="modal-actions">
        <button onclick="createRoom()">Create</button>
        <button onclick="closeModal('createRoomModal')">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Add Contact Modal -->
  <div id="addContactModal" class="modal">
    <div class="modal-content">
      <h2>Add Contact</h2>
      <input type="text" id="searchUsersInput" placeholder="Search users..." onkeyup="searchUsers()">
      <div id="searchResults" class="search-results"></div>
      <div class="modal-actions">
        <button onclick="closeModal('addContactModal')">Close</button>
      </div>
    </div>
  </div>

  <!-- Invite to Room Modal -->
  <div id="inviteModal" class="modal">
    <div class="modal-content">
      <h2>Invite to Room</h2>
      <p>Select contacts to invite to <strong id="inviteRoomName"></strong></p>
      <div id="inviteContactsList" class="invite-list"></div>
      <div class="modal-actions">
        <button onclick="sendInvites()">Send Invites</button>
        <button onclick="closeModal('inviteModal')">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Direct Message Modal -->
  <div id="dmModal" class="modal">
    <div class="modal-content">
      <h2>Start Direct Message</h2>
      <p>Create a private room with <strong id="dmContactName"></strong></p>
      <div class="modal-actions">
        <button onclick="createDM()">Start Chat</button>
        <button onclick="closeModal('dmModal')">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div id="settingsModal" class="modal">
    <div class="modal-content settings-content">
      <h2>‚öôÔ∏è Settings</h2>
      
      <div class="settings-section">
        <h3>üé® Appearance</h3>
        <div class="setting-item">
          <label>Theme</label>
          <select id="themeSelect" onchange="changeTheme()">
            <option value="dark">Dark (Default)</option>
            <option value="midnight">Midnight Blue</option>
            <option value="forest">Forest Green</option>
            <option value="sunset">Sunset Orange</option>
            <option value="ocean">Ocean Blue</option>
          </select>
        </div>
        
        <div class="setting-item">
          <label>Accent Color</label>
          <input type="color" id="accentColor" value="#6366f1" onchange="changeAccentColor()">
        </div>

        <div class="setting-item">
          <label>Font Size</label>
          <select id="fontSizeSelect" onchange="changeFontSize()">
            <option value="small">Small</option>
            <option value="medium" selected>Medium</option>
            <option value="large">Large</option>
          </select>
        </div>
      </div>

      <div class="settings-section">
        <h3>üîî Notifications</h3>
        <div class="setting-item">
          <label>
            <input type="checkbox" id="soundEnabled" checked onchange="saveSettings()">
            Message Sounds
          </label>
        </div>
        <div class="setting-item">
          <label>
            <input type="checkbox" id="desktopNotifs" checked onchange="saveSettings()">
            Desktop Notifications
          </label>
        </div>
        <div class="setting-item">
          <label>
            <input type="checkbox" id="mentionOnly" onchange="saveSettings()">
            Only notify when mentioned
          </label>
        </div>
      </div>

      <div class="settings-section">
        <h3>üí¨ Chat</h3>
        <div class="setting-item">
          <label>
            <input type="checkbox" id="enterToSend" checked onchange="saveSettings()">
            Enter to send messages
          </label>
        </div>
        <div class="setting-item">
          <label>
            <input type="checkbox" id="showTimestamps" checked onchange="saveSettings()">
            Show timestamps
          </label>
        </div>
        <div class="setting-item">
          <label>
            <input type="checkbox" id="compactMode" onchange="toggleCompactMode()">
            Compact message view
          </label>
        </div>
      </div>

      <div class="settings-section">
        <h3>üåê Network</h3>
        <div class="setting-item">
          <label>
            <input type="checkbox" id="autoSync" checked onchange="saveSettings()">
            Auto-sync with peers
          </label>
        </div>
        <div class="setting-item">
          <label>Sync Interval (seconds)</label>
          <input type="number" id="syncInterval" value="30" min="10" max="300" onchange="saveSettings()">
        </div>
      </div>

      <div class="settings-section">
        <h3>üë§ Profile</h3>
        <div class="setting-item">
          <label>Profile Picture</label>
          <div class="avatar-upload">
            <div class="avatar-preview" id="avatarPreview">
              <span id="avatarPreviewText">?</span>
            </div>
            <input type="file" id="avatarUpload" accept="image/*" onchange="uploadAvatar()" style="display: none;">
            <button onclick="document.getElementById('avatarUpload').click()">Choose Image</button>
            <button onclick="removeAvatar()">Remove</button>
          </div>
        </div>
        <div class="setting-item">
          <label>Display Name</label>
          <input type="text" id="profileDisplayName" placeholder="Your display name" onchange="updateProfile()">
        </div>
        <div class="setting-item">
          <label>Status Message</label>
          <input type="text" id="statusMessage" placeholder="What's on your mind?" maxlength="100" onchange="updateProfile()">
        </div>
      </div>

      <div class="modal-actions">
        <button onclick="resetSettings()">Reset to Default</button>
        <button onclick="closeModal('settingsModal')">Close</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
